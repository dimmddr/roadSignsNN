# Методы

## метод nn_init
Создает нейронные сети с переданными ему параметрами
### Параметры метода:
5. **Скорость обучения (alfa)**
  _Число с плавающей точкой_
2. **Размеры окна на изображении** 
(для нейронной сети это единичное изображение)
_Тупл с длиной равной количеству нейросетей, содержит туплы_
    Состоит из:
  * Ширина
      _Целое число_
  * Высота
      _Целое число_
  * Количество слоев
      _Целое число, скорее всего 3, но может быть = 1. 
      Крайне маловероятно другое значение_
4. **Количество обучаэщих примеров на одном шаге (batch size)**
    _Тупл, целых чисел с длиной равной количеству нейросетей._
6. **Количество фильтров**
  Различное для каждой сети
  _Тупл, с длиной равной количеству нейросетей. 
  Каждый элемент - тупл целых чисел. 
  Каждое целое число - размер соответствующего по очереди слоя.
  Для сверточного слоя это будет количество фильтров, 
  для полносвязного - количество нейронов и т.д._
7. **Размер фильтров**
  Различный для каждой сети
  _Тупл с длиной равной количеству нейросетей.
   Каждый элемент это тупл целых чисел длиной 2, 
   определяет размер фильтров(длину и ширину) для сверточного слоя. 
   Сейчас предполагается не более одного сверточного слоя в сети._
       
## метод learning
Производит обучение нейросетей созданых в методе nn_init
### Параметры метода:
1. train_set
    Набор изображений для обучения
2. lbl_train
    Набор меток для изображений
3. neural_nets
    Список нейросетей созданных методом nn_init
    _Тупл нейросетей_
4. nn_for_learn
    Метки, определяющие какие нейросети нужно обучать, а какие - нет.
    _Тупл булевских значений, с длиной равной количеству нейросетей_
5. indexes
    _Тупл целых чисел. 
    Определяет изображения для обучения каждой конкретной нейросети из общего списка_
6. debug
    Значение определящее вывод дебаг информации
    _Булевское значение, по умолчанию = False_
    
    
# Обучение
Для обучения идея такая:
У меня есть несколько цепочек нейросетей
    **1. Цепочка локализации**
        Это первая третья и пятая нейросети. Каждая последующая "видит" картинку несколько более подробно,
            но при этом видит меньше картинок. В обучении каждая последующая учится на результатах предыдущей.
        Результат этих сетей бинарный для каждого окна: есть знак или нет.
    **2. Цепочка калибровки**
        Здесь в данный момент только две сети: вторая и четвертая. Также вторая видит картинку несколько подробнее первой.
            Но, в отличии от цепочки локализации количество картинок такое же.
        Первая сеть определяет "якорь" для второй. Это значит что первая сеть грубо определяет необходимый размер окна
        для знака, а вторая уточняет этот размер. Например, если знаки у меня могут быть от 10х10 пикселей до 110х110, то
        первая сеть может, например, выбирать между 30х30, 50х50, 70х70, 90х90, а вторая менять этот результат на +-10
        Обучаются также вторая на результатах первой. Для первой изображение подготавливается независимо от
        цепочки локализации
    **3. Цепочка распознавания**
        Вообще, в данный момент, здесь всего одна нейросеть. Она распознает найденный дорожный знак.
        Обучаться будет независимо от остальных цепочек на размеченных знаках.

Таким образом мне необходимо три разных функции подготовки данных и три разных функции обучения.